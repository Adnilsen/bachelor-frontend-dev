<body id="collateralPage">
<mat-progress-spinner mode="indeterminate" *ngIf='loading'></mat-progress-spinner>
<section *ngIf='!loading'>
  <div>
    <h1>{{'collateral-page.title' | translate}}</h1>
    <app-information-area [headerText]='"collateral-page.sub-title"' [mainText]='"collateral-page.information-content"'></app-information-area>
  </div>
  <div class='expandable-container'>
    <mat-accordion>
      <mat-expansion-panel [expanded]="panelOpenState" (opened)="panelOpenState = true" (closed)="panelOpenState = false">
        <mat-expansion-panel-header collapsedHeight="5rem" expandedHeight="5rem">
          <mat-panel-title>
            <img [src]="'assets/images/house.svg'" alt=''/>
            <div *ngIf='collateral'>
              <strong><p>
                {{'collateral-page.expansion-panel.title' | translate}}
              </p></strong>
              <p>{{collateral.realEstate.address}}<br>{{collateral.realEstate.postalCode}} {{postName.result}}</p>
            </div><div *ngIf='!collateral'>
            <strong><p>
              {{'collateral-page.expansion-panel.error-title' | translate}}
            </p></strong>
          </div>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <div>
          <form [formGroup]='form'>
            <div class='formFieldContainerWide'>
              <label class='selectorLabel'>{{'collateral-page.expansion-panel.content.housing-type-title' | translate}}</label>
              <mat-form-field appearance="fill">
                <input matInput aria-label="realEstateType" value='{{collateral ? this.collateral.realEstate.type : ""}}' [disabled]='collateral !== undefined'>
              </mat-form-field>
            </div>
            <div *ngIf='selectedType === "HOUSING-CO-OPERATIVE"'>
              <div class='formFieldContainerWide'>
                <label class='selectorLabel'>{{'collateral-page.expansion-panel.content.housing-co-operative.choose-co-operative' | translate}}</label>
                <mat-form-field appearance="fill">
                  <input matInput aria-label="cooperativeName" value='{{collateral ? collateral.realEstate.cooperativeName : ""}}' [disabled]='collateral !== undefined'>
                </mat-form-field>
              </div>
              <div class='formFieldContainer'>
                <label class='selectorLabel'>{{'collateral-page.expansion-panel.content.housing-co-operative.unit-number' | translate}}</label>
                <mat-form-field appearance="fill">
                  <input matInput aria-label="unitNumber" value='{{collateral ? collateral.realEstate.unitNumber : ""}}' [disabled]='collateral !== undefined'>
                </mat-form-field>
              </div>
              <div class='formFieldContainer'>
                <label class='selectorLabel'>{{'collateral-page.expansion-panel.content.purchase-amount-title' | translate}}</label>
                <mat-form-field appearance="fill">
                  <input matInput aria-label="purchaseAmount" [formControl]="purhaseAmount" [mask]="'separator'" [disabled]='collateral !== undefined'>
                  <mat-error *ngIf="purhaseAmount.invalid">{{'collateral-page.expansion-panel.content.purchase-amount-error' | translate}}</mat-error>
                </mat-form-field>
              </div>
              <div class='formFieldContainer'>
                <label class='selectorLabel'>{{'collateral-page.expansion-panel.content.housing-co-operative.shared-debt-title' | translate}}</label>
                <mat-form-field appearance="fill">
                  <input matInput aria-label="sharedDebt" [formControl]="sharedDebt" [mask]="'separator'" [disabled]='collateral !== undefined'>
                  <mat-error *ngIf="sharedDebt.invalid">{{'collateral-page.expansion-panel.content.housing-co-operative.shared-debt-error' | translate}}</mat-error>
                </mat-form-field>
              </div>
            </div>
            <div *ngIf='selectedType === "CONDOMINIUM"'>
              <div class='formFieldContainerWide'>
                <label class='selectorLabel'>{{'collateral-page.expansion-panel.content.condominium.address-title' | translate}}</label>
                <mat-form-field appearance="fill">
                  <input matInput [formControl]="addressControl">
                  <mat-error *ngIf='addressControl.invalid'>{{'collateral-page.expansion-panel.content.condominium.address-error' | translate}}</mat-error>
                </mat-form-field>
              </div>
              <div class='formFieldContainer'>
                <label class='selectorLabel'>{{'collateral-page.expansion-panel.content.condominium.postal-code-title' | translate}}</label>
                <mat-form-field appearance="fill">
                  <input matInput [formControl]="postalNumberControl" [mask]="'0000'">
                  <mat-error *ngIf="postalNumberControl.invalid">{{'collateral-page.expansion-panel.content.condominium.postal-code-error' | translate}}</mat-error>
                </mat-form-field>
              </div>
              <div class='formFieldContainer'>
                <label class='selectorLabel'>{{'collateral-page.expansion-panel.content.condominium.cadastral-number-title' | translate}}</label>
                <mat-form-field appearance="fill">
                  <input matInput value='{{collateral ? collateral.realEstate.cadastralNumber : ""}}'>
                </mat-form-field>
              </div>
              <div class='formFieldContainer'>
                <label class='selectorLabel'>{{'collateral-page.expansion-panel.content.condominium.title-number-title' | translate}}</label>
                <mat-form-field appearance="fill">
                  <input matInput value='{{collateral ? collateral.realEstate.titleNumber : ""}}'>
                </mat-form-field>
              </div>
              <div class='formFieldContainer'>
                <label class='selectorLabel'>{{'collateral-page.expansion-panel.content.condominium.section-number-title' | translate}}</label>
                <mat-form-field appearance="fill">
                  <input matInput value='{{collateral ? collateral.realEstate.sectionNumber : ""}}'>
                </mat-form-field>
              </div>
              <div class='formFieldContainer'>
                <label class='selectorLabel'>{{'collateral-page.expansion-panel.content.condominium.lease-number-title' | translate}}</label>
                <mat-form-field appearance="fill">
                  <input matInput value='{{collateral ? collateral.realEstate.leaseNumber : ""}}'>
                </mat-form-field>
              </div>
              <div class='formFieldContainer'>
                <label class='selectorLabel'>{{'collateral-page.expansion-panel.content.purchase-amount-title' | translate}}</label>
                <mat-form-field appearance="fill">
                  <input matInput [formControl]="purhaseAmount" [mask]="'separator'">
                  <mat-error *ngIf="purhaseAmount.invalid">{{'collateral-page.expansion-panel.content.purchase-amount-error' | translate}}</mat-error>
                </mat-form-field>
              </div>
            </div>
          </form>
        </div>
      </mat-expansion-panel>
    </mat-accordion>
  </div>
  <div style='margin-top: 2rem;'>
    <label class='selectorLabel'>{{'collateral-page.radio-button.title' | translate}}</label>
    <form [formGroup]='coHabitantForm' id='coHabForm' (ngSubmit)="next()">
      <mat-radio-group
        style='margin-top: 0;'
        aria-labelledby="radio-group-label"
        class="radio-group"
        [formControl]='coHabitantControl'
        [(ngModel)]="coHabitant">
        <mat-radio-button class="radio-button" color="primary" [value]="true">
          {{'collateral-page.radio-button.yes' | translate}}
        </mat-radio-button>
        <mat-radio-button class="radio-button" color="primary" [value]="false">
          {{'collateral-page.radio-button.no' | translate}}
        </mat-radio-button>
      </mat-radio-group>
      <mat-error *ngIf="isClicked && coHabitant === undefined">{{'collateral-page.radio-button.co-applicant-error' | translate}}</mat-error>
    </form>
  </div>
  <div style='margin-top: 2rem;'>
    <div style='display: flex; flex-direction: column; width: 100%'>
      <div style="margin-bottom: 0.2rem; display: flex; flex-direction: row; align-content: center;">
        <label class='selectorLabel'>Ønsket lånebeløp</label>
        <!--button mat-mini-fab color="primary" (click)="displayHelp()">?</button-->
      </div>
      <label class="sublabel" style="width: 70%;" *ngIf="loanAmountHelp">Ønsket lånebeløp kan ikke overstige 85% av kjøpsverdi. <br>Maks lånebeløp er:</label>
      <div style="width: 50%">
        <mat-form-field appearance="fill">
          <input matInput [(ngModel)]='requiredLoanAmount' placeholder="0" [mask]='"separator"' (ngModelChange)='inputLoanAmountChanged($event)' [formControl]="requiredLoanAmountController">
        </mat-form-field>
        <mat-error class='error' *ngIf="requiredLoanAmountController.invalid && isClicked || requiredLoanAmountController.invalid && requiredLoanAmountController.touched">*Skriv inn ønsket lånebeløp</mat-error>
      </div>
    </div>
  </div>
  <section class='navigation-button-container'>
    <button mat-stroked-button color='primary' (click)='previous()'>Forrige</button>
    <button mat-stroked-button color='warn' (click)='cancel()'>Avbryt</button>
    <button mat-raised-button color="primary" form='coHabForm' type='submit'>Neste</button>
  </section>
</section>
</body>
